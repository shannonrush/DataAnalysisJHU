setwd("~/git/DataAnalysisJHS/data/processed")
load("../raw/loansData.rda") # loansData 2500 x 14
# there are so few NAs probably ok to just remove them
data <- na.omit(loansData)
str(data)
levels(data$FICO.Range)
table(data$FICO.Range)
levels(data$FICO.Range)
levels(data$FICO.Range) <- levels(data$FICO.Range)[levels(data$FICO.Range)!=""]
data$FICO.Range <- factor(data$FICO.Range)
data$FICO.Range
levels(data$FICO.Range)
a<-"640-644"
?gsub
sub("-.*","",a)
as.numeric(sub("-.*","",a))
data$FICO <- sapply(data$FICO.Range, function(x) as.numeric(sub("-.*","",x)))
data$FICO
plot(data$FICO,data$Interest.Rate)
table(data$Interest.Rate)
str(data$Interest.Rate)
data$Rate <- sapply(data$Interest.Rate, function(x) as.numeric(sub("%","",x)))
data$Rate
plot(data$FICO,data$Rate)
plot(data$FICO,data$Rate,pch=19)
plot(data$FICO,data$Rate,pch=19,cex=0.1)
plot(data$FICO,data$Rate,pch=19,cex=0.5)
quantile(data$FICO)
quantile(data$Rate)
str(data)
?cut
quantile(data$Monthly.Income)
boxplot(data$Monthly.Income)
?cut
cut(data$Monthly.Income,10000)
cut(data$Monthly.Income,10)
cut(data$Monthly.Income,10,labels=F)
data$Income.Level <- cut(data$Monthly.Income,10,labels=F)
table(data$Income.Level)
data$Income.Level <- cut(data$Monthly.Income,20,labels=F)
table(data$Income.Level)
data$Income.Levels <- cut(data$Monthly.Income,20)
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level)
?legend
legend(20,20)
legend("topright")
library(graphics)
legend("topright")
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level)
legend("topright")
legend("topright",levels(data$Income.Levels))
table(data$Income.Levels)
data$Income.Levels <- factor(cut(data$Monthly.Income,20))
table(data$Income.Levels)
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level)
legend("topright",levels(data$Income.Levels))
legend("topright",levels(data$Income.Levels),col=data$Income.Level)
data$Income.Level <- factor(cut(data$Monthly.Income,20,labels=F))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level)
legend("topright",levels(data$Income.Levels),col=data$Income.Level)
?fill
legend("topright",levels(data$Income.Levels),fill=T,col=data$Income.Level)
legend("topright",levels(data$Income.Levels),fill=data$Income.Level)
table(data$Income.Level)
data$Income.Level <- factor(cut(data$Monthly.Income,20,labels=1:8))
data$Income.Level <- factor(cut(data$Monthly.Income,20,labels=F))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=1:8)
legend("topright",levels(data$Income.Levels),fill=1:8)
data$Income.Level <- factor(cut(data$Monthly.Income,5,labels=F))
table(data$Income.Level)
plot(data$Monthly.Income)
plot(log(data$Monthly.Income)
)
quantile(data$Monthly.Income)
plot(data$Monthly.Income)
data$Adj.Income <- sapply(data$Monthly.Income, function(x) ifelse (x>10000,10000,x))
quantile(data$Adj.Income)
data$Income.Level <- factor(cut(data$Adj.Income,5,labels=F))
data$Income.Levels <- factor(cut(data$Adj.Income,5))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level)
legend("topright",levels(data$Income.Levels),fill=data$Income.Level)
levels(data$Income.Level)
table(data$Income.Level)
?col
legend("topright",levels(data$Income.Levels),fill=1)
legend("topright",levels(data$Income.Levels),fill=2)
legend("topright",levels(data$Income.Levels),fill=3)
head(data$Income.Level)
legend("topright",levels(data$Income.Levels),fill=levels(data$Income.Level))
library(randomForest)
install.packages("randomForest")
randomForest(data$Rate ~.,do.trace=T,importance=T)
library(randomForest)
randomForest(data$Rate ~.,do.trace=T,importance=T)
rf <- randomForest(data$Rate ~.,data=date,do.trace=T,importance=T)
str(data)
data$FICO.Range <- NULL
data$Interest.Rate <- NULL
str(data)
data$Debt.Income.Ratio <- sapply(data$Debt.To.Income.Ratio, function(x)as.numeric(sub"%","",x))
data$Debt.Income.Ratio <- sapply(data$Debt.To.Income.Ratio, function(x)as.numeric(sub("%","",x))
)
data$Debt.To.Income.Ratio <- NULL
data$Debt.Income.Ratio
str(data)
data$Loan.Purpose
as.numeric(data$Loan.Purpose)
data$Loan.Purpose
str(data)
save(data,file="loansData_Clean.rda")
setwd("~/git/DataAnalysisJHS/code/exploratory")
load("../../data/processed/loansData_Clean.rda")
load("../../data/processed/loansData_Clean.rda")
?cor
cor(data)
str(data)
library(randomForest)
data$State <- NULL
randomForest(Rate ~.,data=data,do.trace=T,importance=T)
rf <- randomForest(Rate ~.,data=data,do.trace=T,importance=T)
importance(rf)
setwd("~/git/DataAnalysisJHS/figures/exploratory")
legend("topright",levels(data$Income.Levels),fill=levels(data$Income.Level),main="Rate By FICO and Income")
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=data$Income.Level,main="Rate By FICO and Income")
legend("topright",levels(data$Income.Levels),fill=levels(data$Income.Level))
str(data)
cut(data$FICO,5)
str(data)
?lm
lm(data$Rate ~.,data=data)
lm<-lm(data$Rate ~.,data=data)
plot(lm)
str(data)
load("../../data/processed/loansData_Clean.rda") # data 2498 x 16
plot(data$Amount.Requested,data$Rate)
data$FICO.Level <- cut(data$FICO,5,labels=F)
data$FICO.Levels <- cut(data$FICO,5)
plot(data$Amount.Requested,data$Rate,pch=19,cex=0.5,col=data$FICO.Level)
legend("topright",levels(data$FICO.Levels),fill=levels(data$FICO.Level))
levels(data$FICO.Level)
data$FICO.Level
data$FICO.Level <- factor(cut(data$FICO,5,labels=F))
data$FICO.Level
legend("topright",levels(data$FICO.Levels),fill=levels(data$FICO.Level))
par(xpd=TRUE)
legend("topright",levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(2,1,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
plot(data$Amount.Requested,data$Rate,pch=19,cex=0.5,col=data$FICO.Level)
par(xpd=TRUE)
legend(20,20,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(40,20,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
plot(data$Amount.Requested,data$Rate,pch=19,cex=0.5,col=data$FICO.Level)
par(xpd=TRUE)
legend(40,20,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(40,40,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
plot(data$Amount.Requested,data$Rate,pch=19,cex=0.5,col=data$FICO.Level)
par(xpd=TRUE)
legend(0,40,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(0,0,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(0,20,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(0,30,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(20,30,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(-20,30,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
plot(data$Amount.Requested,data$Rate,pch=19,cex=0.5,col=data$FICO.Level)
par(xpd=TRUE)
legend(-20,30,levels(data$FICO.Levels),fill=levels(data$FICO.Level))
legend(-20,30,levels(data$FICO.Levels),fill=levels(data$FICO.Level),title="FICO")
str(data)
plot(data$FICO,data$Rate,pch=19,cex=0.5)
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(data$Loan.Length))
table(data$Loan.Length)
legend("topright",data$Loan.Length)
legend("topright",levels(data$Loan.Length))
legend("topright",levels(data$Loan.Length),fill=as.numeric(data$Loan.Length))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Length)))
legend("topright",levels(data$Loan.Length),fill=as.numeric(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=as.numeric(factor(data$Loan.Length)))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=as.numeric(factor(data$Loan.Length)))
factor(data$Loan.Length))
factor(data$Loan.Length)
as.numeric(factor(data$Loan.Length))
factor(as.numeric(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=factor(as.numeric(factor(data$Loan.Length))))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=levels(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=as.numeric(levels(factor(data$Loan.Length))))
legend("topright",levels(factor(data$Loan.Length)),fill=as.numeric(factor(data$Loan.Length))))
legend("topright",levels(factor(data$Loan.Length)),fill=1:2)
levels(as.numeric(data$Loan.Length))
levels(as.numeric(factor(data$Loan.Length)))
as.numeric(factor(data$Loan.Length))
factor(as.numeric(factor(data$Loan.Length)))
levels(factor(as.numeric(factor(data$Loan.Length))))
legend("topright",levels(factor(data$Loan.Length)),fill=levels(factor(as.numeric(factor(data$Loan.Length)))))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Length)))
legend("topright",levels(factor(data$Loan.Length)),fill=levels(factor(as.numeric(factor(data$Loan.Length)))),title="Loan Length")
str(data)
plot(data$Amount.Requested,data$Amount.Funded.By.Investors)
plot(data$Amount.Requested,data$Amount.Funded.By.Investorse,pch=19,cex=0.5,col=data$FICO.Level)
plot(data$Amount.Requested,data$Amount.Funded.By.Investors,pch=19,cex=0.5,col=data$FICO.Level)
legend("topleft",levels(data$FICO.Levels),fill=levels(data$FICO.Level),title="FICO")
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Purpose)))
legend("topright",levels(data$Loan.Purpose),fill=levels(as.numeric(factor(data$Loan.Length))),title="Loan Purpose")
legend("topright",levels(data$Loan.Purpose),fill=levels(as.numeric(factor(data$Loan.Purpose))),title="Loan Purpose")
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(factor(data$Loan.Purpose)))
levels(as.numeric(factor(data$Loan.Purpose)))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=as.numeric(data$Loan.Purpose))
legend("topright",levels(data$Loan.Purpose),fill=levels(as.numeric(data$Loan.Purpose)),title="Loan Purpose")
as.numeric(data$Loan.Purpose)
levels(as.numeric(data$Loan.Purpose))
levels(as.numeric(factor(data$Loan.Purpose)))
levels(factor(as.numeric(data$Loan.Purpose)))
plot(data$FICO,data$Rate,pch=19,cex=0.5,col=factor(as.numeric(data$Loan.Purpose)))
legend("topright",levels(data$Loan.Purpose),fill=levels(factor(as.numeric(data$Loan.Purpose))),title="Loan Purpose")
table(data$Loan.Purpose)
